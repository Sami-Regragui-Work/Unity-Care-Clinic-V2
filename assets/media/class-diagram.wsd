@startuml

' CLASS THEME (ORIGINAL)
skinparam classAttributeIconSize 0
skinparam RoundCorner 15
skinparam Dpi 300
hide <<spotClass>> stereotype


<style>
spotClass {
  BackgroundColor #FFFACD
  LineColor darkred
  FontColor darkred
}
</style>

skinparam class {
  BackgroundColor #LightGreen
  ArrowFontStyle bold
  ArrowFontSize 16
  FontStyle bold
  FontColor darkred
  AttributeFontSize 18
}

' ==========================
' Infra: custom BaseModel + Validator
' ==========================

class BaseModel <<spotClass>> {
  - tableName : string
  - idField : string

  + save() : bool
  + delete() : bool
  + findById(id : int) : ?BaseModel
  + getId() : int

  # getTableName() : string
  # setTableName(name : string) : void
  # getIdField() : string
  # setIdField(field : string) : void
}

class Validator <<spotClass>> {
  + isValidEmail(email : string) : bool
  + isValidPhone(phone : string) : bool
  + isValidDate(date : string) : bool
  + isNotEmpty(input : string) : bool
  + sanitize(input : string) : string
}

' ==========================
' Generic / Parent classes
' ==========================

abstract class Table {
  - id : int

  # getId() : int
  # setId(id : int) : void

  + toArray() : array
  + getDisplayHeaders() : array
}

abstract class Person {
  - firstName : string
  - lastName : string
  - phone : string
  - email : string
  - hireDate : \DateTime

  # getFirstName() : string
  # setFirstName(firstName : string) : void
  # getLastName() : string
  # setLastName(lastName : string) : void
  # getPhone() : string
  # setPhone(phone : string) : void
  # getEmail() : string
  # setEmail(email : string) : void

  + getFullName() : string
  + __toString() : string
}

' ==========================
' Main entity classes
' ==========================

class Patient {
  - birthDate : \DateTime
  - gender : string
  - departmentId : int

  # getBirthDate() : \DateTime
  # setBirthDate(date : \DateTime) : void
  # getGender() : string
  # setGender(gender : string) : void
  # getDepartmentId() : int
  # setDepartmentId(deptId : int) : void

  + calculateAverageAge() : float
  + countByDepartment() : array
}

class Doctor {
  - speciality : string
  - departmentId : int

  # getSpeciality() : string
  # setSpeciality(speciality : string) : void
  # getDepartmentId() : int
  # setDepartmentId(deptId : int) : void

  + calculateAverageYearsOfService() : float
  + findByDepartment(deptId : int) : array
}

class Department {
  - name : string
  - location : string

  # getName() : string
  # setName(name : string) : void
  # getLocation() : string
  # setLocation(location : string) : void

  + getMostPopulated() : Department
}

' ==========================
' Inheritance relations
' ==========================

BaseModel <|-- Table : <<inheritance>>
Table <|-- Person : <<inheritance>>

Table <|-- Patient : <<inheritance>>
Table <|-- Doctor : <<inheritance>>
Table <|-- Department : <<inheritance>>

Person <|-- Patient : <<inheritance>>
Person <|-- Doctor : <<inheritance>>

' Validator is used by entities via setters (not inherited)
Validator ..> Patient : <<composition>> validates input
Validator ..> Doctor : <<composition>> validates input
Validator ..> Department : <<composition>> validates input

@enduml
